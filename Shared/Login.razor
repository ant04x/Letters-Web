@inherits LayoutComponentBase
@inject NavigationManager NavigationManager

<EditForm class="loginScreen" Model="@Creds">

    <label class="addresseTextField mdc-text-field mdc-text-field--outlined">
        <span class="mdc-notched-outline">
            <span class="mdc-notched-outline__leading"></span>
            <span class="mdc-notched-outline__notch">
                <span class="mdc-floating-label" id="my-label-id">Destinatarios</span>
            </span>
            <span class="mdc-notched-outline__trailing"></span>
        </span>
        <!--<input type="text" class="mdc-text-field__input" aria-labelledby="my-label-id">-->
        <InputText id="toEmail" @bind-Value="Creds.UserName" type="text" class="mdc-text-field__input" aria-labelledby="my-label-id" />
    </label>

    <label class="affairTextField mdc-text-field mdc-text-field--outlined">
        <span class="mdc-notched-outline">
            <span class="mdc-notched-outline__leading"></span>
            <span class="mdc-notched-outline__notch">
                <span class="mdc-floating-label" id="my-label-id">Asunto</span>
            </span>
            <span class="mdc-notched-outline__trailing"></span>
        </span>
        <!--<input type="text" class="mdc-text-field__input" aria-labelledby="my-label-id">-->
        <InputText id="subjectEmail" @bind-Value="Creds.UserPass" type="text" class="mdc-text-field__input" aria-labelledby="my-label-id2" />
    </label>

    <button @onclick="OnEnterClick" type="submit" class="mdc-button--raised">
        <span class="mdc-button__label">Entrar</span>
    </button>

</EditForm>

@code {

    public static Credentials Creds
    {
        get;
        private set;
    } = new Credentials();

    protected async void OnEnterClick()
    {
        using (var smtp = new MailKit.Net.Smtp.SmtpClient())
        {
            smtp.ServerCertificateValidationCallback = (s, c, h, e) => true;
            Console.WriteLine("NOMBRE DE USUARIO Y PASS: " + Login.Creds.UserName + " " + Login.Creds.UserPass);

            await smtp.ConnectAsync("smtp-mail.outlook.com", 587, MailKit.Security.SecureSocketOptions.StartTls);
            await smtp.AuthenticateAsync(Login.Creds.UserName, Login.Creds.UserPass);
            await smtp.DisconnectAsync(true);
        }
        NavigationManager.NavigateTo("/home", true);
    }

}